<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>DailyAI Italia — Directory di tool AI</title>
<style>
:root{--bg:#fff;--fg:#0f172a;--muted:#6b7280;--border:#e5e7eb;--chip:#f3f4f6;--brand:#111827;}
*{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial}
a{color:inherit} .container{max-width:1200px;margin:auto;padding:16px}
header{position:sticky;top:0;background:rgba(255,255,255,.92);backdrop-filter:saturate(180%) blur(8px);border-bottom:1px solid var(--border);z-index:5}
.header-inner{display:flex;align-items:center;gap:12px;padding:12px 16px}
.brand{display:flex;align-items:center;gap:8px;font-weight:700}
.brand-badge{width:28px;height:28px;border-radius:8px;background:var(--brand);color:#fff;display:grid;place-items:center;font-size:13px}
.layout{display:grid;grid-template-columns:260px 1fr;gap:20px;margin-top:16px}
@media (max-width: 900px){ .layout{grid-template-columns:1fr} aside{order:2} main{order:1} }
.searchbar{display:flex;gap:8px;margin:12px 0}
.searchbar input{flex:1;padding:10px 12px;border:1px solid var(--border);border-radius:10px}
.counter{color:var(--muted);font-size:14px;margin:6px 0}
aside .card{border:1px solid var(--border);border-radius:14px;padding:12px}
.cat-list{list-style:none;padding:0;margin:8px 0 0;max-height:70vh;overflow:auto}
.cat-btn{width:100%;text-align:left;padding:8px 10px;border:0;border-radius:10px;cursor:pointer}
.cat-btn.active{background:#111827;color:white}
.cat-btn:not(.active):hover{background:#f3f4f6}
.badge{display:inline-block;border:1px solid var(--border);padding:3px 8px;border-radius:999px;font-size:12px;background:var(--chip);color:#111}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
@media (max-width:1100px){.grid{grid-template-columns:repeat(2,1fr)}}
@media (max-width:650px){.grid{grid-template-columns:1fr}}
.card{border:1px solid var(--border);border-radius:16px;overflow:hidden;background:#fff;transition:box-shadow .15s}
.card:hover{box-shadow:0 6px 20px rgba(0,0,0,.06)}
.card .cover{aspect-ratio:16/9;background:#f3f4f6;overflow:hidden}
.card .cover img{width:100%;height:100%;object-fit:cover;display:block;transition:transform .2s}
.card:hover .cover img{transform:scale(1.02)}
.card .body{padding:12px}
.tool-head{display:flex;gap:10px;align-items:center;margin-bottom:8px}
.tool-head img{width:34px;height:34px;border-radius:6px;object-fit:cover;background:#eee}
.tool-name{font-weight:700;margin:0}
.tool-tagline{color:var(--muted);font-size:13px;margin:0}
.tool-desc{font-size:14px;color:#1f2937;margin:8px 0 10px;min-height:40px}
.chips{display:flex;gap:6px;flex-wrap:wrap}
.footer{border-top:1px solid var(--border);margin-top:22px;padding:14px 0;color:var(--muted);font-size:14px}
.hidden{display:none}
</style>
</head>
<body>

<header>
  <div class="container header-inner">
    <div class="brand"><div class="brand-badge">AI</div> DailyAI Italia</div>
    <div style="flex:1"></div>
    <nav class="hide-mobile" style="display:flex;gap:14px;font-size:14px">
      <a href="./">Home</a><a href="./">Tool</a><a href="./news.html">Notizie</a><a href="./submit.html">Suggerisci</a>
    </nav>
  </div>
</header>

<div class="container">
  <div class="searchbar">
    <input id="q" placeholder="Cerca tool (nome, descrizione, tag)..." />
  </div>
  <div class="counter" id="counter"></div>

  <div class="layout">
    <!-- SIDEBAR -->
    <aside>
      <div class="card">
        <strong>Categorie</strong>
        <ul class="cat-list" id="cat-list"></ul>
        <div style="margin-top:10px"><label style="font-size:14px"><input type="checkbox" id="only-free" /> Solo gratis</label></div>
      </div>
    </aside>

    <!-- GRID -->
    <main>
      <div id="grid" class="grid"></div>
    </main>
  </div>

  <div class="footer">© <span id="y"></span> DailyAI Italia • Directory di strumenti di intelligenza artificiale</div>
</div>

<script>
document.getElementById("y").textContent = new Date().getFullYear();

const state = { q: "", cat: "Tutti", onlyFree: false, data: {tools:[], updated_at:null} };
const EL = {
  grid: document.getElementById("grid"),
  cats: document.getElementById("cat-list"),
  q: document.getElementById("q"),
  onlyFree: document.getElementById("only-free"),
  counter: document.getElementById("counter"),
};

const CATEGORIES = [
  "Tutti","Scrittura","Immagini","Video","Audio","Agenti","Automazione",
  "Produttività","Dev e code","SEO e marketing","E-commerce","Dati e analytics","Ricerca"
];

function esc(s){return (s||"").replace(/[&<>\"']/g,m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[m]))}

function renderCategories(active){
  EL.cats.innerHTML = CATEGORIES.map(c => `
    <li><button class="cat-btn ${c===active?'active':''}" data-cat="${c}">${c}</button></li>
  `).join("");
  EL.cats.querySelectorAll("button").forEach(b=>{
    b.onclick = ()=>{ state.cat = b.dataset.cat; renderAll(); };
  });
}

function filterTools(){
  const q = state.q.toLowerCase().trim();
  return state.data.tools.filter(t=>{
    const text = `${t.name} ${t.tagline||""} ${t.description||""} ${(t.badges||[]).join(" ")} ${(t.categories||[]).join(" ")}`.toLowerCase();
    const okQ = q ? text.includes(q) : true;
    const okC = state.cat==="Tutti" ? true : (t.categories||[]).includes(state.cat);
    const okF = state.onlyFree ? /gratis|free/i.test(t.pricing||"") : true;
    return okQ && okC && okF;
  });
}

function card(t){
  return `
  <a class="card" href="tool.html?slug=${encodeURIComponent(t.slug)}">
    <div class="cover"><img src="${t.cover}" alt=""></div>
    <div class="body">
      <div class="tool-head">
        <img src="${t.logo}" alt="">
        <div>
          <div class="tool-name">${esc(t.name)}</div>
          <div class="tool-tagline">${esc(t.tagline||"")}</div>
        </div>
      </div>
      <p class="tool-desc">${esc(t.description||"")}</p>
      <div class="chips">
        ${(t.categories||[]).slice(0,3).map(c=>`<span class="badge">${esc(c)}</span>`).join("")}
        ${(t.badges||[]).slice(0,2).map(b=>`<span class="badge">${esc(b)}</span>`).join("")}
      </div>
    </div>
  </a>`;
}

function renderGrid(list){
  EL.grid.innerHTML = list.map(card).join("");
  EL.counter.textContent = `${list.length} risultati • aggiornato ${state.data.updated_at ? new Date(state.data.updated_at).toLocaleDateString('it-IT') : ''}`;
}

function renderAll(){
  renderCategories(state.cat);
  const list = filterTools();
  renderGrid(list);
}

async function boot(){
  // carica tools
  const res = await fetch("./public/tools.json?_=" + Date.now());
  state.data = await res.json();
  // bind input
  EL.q.oninput = (e)=>{ state.q = e.target.value; renderAll(); };
  EL.onlyFree.onchange = (e)=>{ state.onlyFree = e.target.checked; renderAll(); };
  renderAll();
}
boot();
</script>
</body>
</html>
